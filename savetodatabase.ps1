function get-diskspaceinfo{    [CmdletBinding()]    param(        [Parameter (Mandatory =$true,                                        Valuefrompipeline =$true,                    Valuefrompipelinebypropertyname=$true)]        [string[]] $computername        )    BEGIN{}    PROCESS{        $disks= get-wmiobject -Class win32_logicaldisk -Filter "drivetype=3" -ComputerName $computername        $props = @{'Computername' =$computer;               'drive' = $disks.deviceid;               'freespace' = "{0:N2}" -f ($disks.frespace /1GB);               'size' = "{0:N2}" -f ($disks.size / 1GB);               'freepercent' = "{0:N2}" -f ($disks.freespace /$_.size * 100)               $obj = New-Object -TypeName PSObject -property $props                                                    }}END{}}function savediskdetailstodatabase{[cmdletbinding()]param([parameter (mandatory =$true, valurfrompipeline=$true)][object[]] $inputobject)BEGIN{$connection = New-Object -TypeName System.Data.SqlClient.SqlConnection$connection.connectionstring = "Server=SQL;Database=admindata;Trusted_Connection=True;"$connection.open()}PROCESS{$command = new-object -TypeName System.Data.SqlClient.SqlCommand$command.Connection = $connection$sql = "DELETE FROM DISKDATA WHERE COMPUTERNAME ='$($inputobject.COMPUTERANAME)' AND DRIVELETTER = '$($inputobject.drive)'"Write-Debug "executing $sql"$command.CommandText = $sql$reader=$command.ExecuteNonQuery() | out-null$sql = "INSERT INTO DiskData (COMPUTERNAME,Driveletter,freespace,size,freepercen) VALUES('$($inputobject.computername)', '$($inputobject.drive)', $($inputobject.freespace), $($inputobject.size), $($inputobject.freepercent))"Write-Debug "executing $sql"$command.CommandText = $sql$command.ExecuteNonQuery() | out-null}END{$connection.close()}}