function get-diskspaceinfo{    [CmdletBinding()]    param(        [Parameter (Mandatory =$true,                                        Valuefrompipeline =$true,                    Valuefrompipelinebypropertyname=$true)]        [string[]] $computername        )    BEGIN{}    PROCESS{        foreach($computer in $computername){    $disks= get-wmiobject -Class win32_logicaldisk -Filter "drivetype=3" -ComputerName $computer    foreach($disk in $disks){        $props = @{'Computername' =$computer;               'drive' = $disk.deviceid               'freespace' = "{0:N2}" -f ($disk.freespace /1GB);               'size' = "{0:N2}" -f ($disk.size / 1GB);               'freepercent' = "{0:N2}" -f ($disk.freespace /$disk.size * 100)              }               $obj = New-Object -TypeName PSObject -property $props               write-output $obj}}}END{}}function savediskdetailstodatabase{[cmdletbinding()]param([parameter (mandatory =$true, valuefrompipeline=$true)][object[]] $inputobject)BEGIN{$connection = New-Object -TypeName System.Data.SqlClient.SqlConnection$connection.connectionstring = "Server=MININT-HQ7ISDD;Database=admindata;Trusted_Connection=True;"$connection.open()}PROCESS{$command = new-object -TypeName System.Data.SqlClient.SqlCommand$command.Connection = $connection$sql = "DELETE FROM DISKDATA1 WHERE COMPUTERNAME ='$($inputobject.Computername)' AND DRIVELETTER = '$($inputobject.drive)'"Write-Debug "executing $sql"$command.CommandText = $sql$command.ExecuteNonQuery() | out-null$sql = "INSERT INTO DiskData1 (COMPUTERNAME,Driveletter,freespace,size,freepercent) VALUES('$($inputobject.computername)', '$($inputobject.drive)', $($inputobject.freespace), $($inputobject.size), $($inputobject.freepercent))"Write-Debug "executing $sql"$command.CommandText = $sql$command.ExecuteNonQuery() | out-null}END{$connection.close()}}function get-computernamefromdatabase{$connection = New-Object -TypeName System.Data.SqlClient.SqlConnection$connection.connectionstring = "Server=MININT-HQ7ISDD;Database=admindata;Trusted_Connection=True;"$connection.open()$command = new-object -TypeName System.Data.SqlClient.SqlCommand$command.Connection = $connection$sql = "SELECT computername FROM DISKDATA1 "Write-Debug "executing $sql"$command.CommandText = $sql$reader = $command.executereader()while($reader.Read()){    $reader.GetSqlString(0).Value   }$connection.Close()}